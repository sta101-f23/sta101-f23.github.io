{
  "hash": "606f6109a5b224d5861dca1a7f25dbd8",
  "result": {
    "markdown": "---\ntitle: \"Tips\"\ncategories: \n  - Application exercise\neditor: visual\n---\n\n\nToday we'll explore the question \"What best predicts what percent of the bill amount people tip at restaurants?\"\n\n# Goals\n\n-   Build, fit, and interpret linear models with more than one predictor\n\n-   Compute $R^2$ and adjusted $R^2$\n\n-   Use adjusted $R^2$ for stepwise model selection\n\n-   Evaluate predictive performance of models\n\n# Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(scales)\n```\n:::\n\n\n# Data\n\nThe data for this application exercise was collected in 2011 by a student at St. Olaf who worked at a local restaurant.[^1]\n\n[^1]: Dahlquist, Samantha, and Jin Dong. 2011. \"The Effects of Credit Cards on Tipping.\" Project for Statistics 212-Statistics for the Sciences, St. Olaf College.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntips <- read_csv(\"data/tips.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 129 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): day, meal, payment, age, gift_card, comps, alcohol, bday\ndbl (5): party, bill, w_tip, tip, tip_percentage\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nThe dataset has 129 observations and 13 columns. Each observation represents a meal by a party at the restaurant, and for each meal we know the bill amount, the tip amount, and a variety of other features like whether the payment was made on credit card or by cash, whether any alcohol was ordered, etc.\n\nTo keep the scope manageable for this application exercise, we'll only consider the following predictors:\n\n-   `meal`: Meal of the day (`Lunch`, `Dinner`, or `Late Night`)\n\n-   `party`: Number of people in the party\n\n-   `alcohol`: Whether the party ordered any alcohol (`No` or `Yes`)\n\n-   `bill`: Bill amount, in USD\n\nWe will aim to predict `tip_percentage` from these variables.\n\n# Exploratory data analysis\n\n## Exercise 1\n\nVisualize the relationship between these variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n## Exercise 2\n\nIn a couple of sentences, describe any apparent patterns.\n\n> Add response here.\n\n# Strength of fit\n\n## Exercise 3\n\nFit a model predicting tip percentage from bill amount. Display and interpret the model coefficients. Additionally, calculate and interpret the $R^2$ of this model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n## Exercise 4\n\nSuppose we next add `meal` as a predictor and interpret the model coefficients again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n## Exercise 5\n\nWould you expect the $R^2$ of the second model (with `bill` and `meal` as predictors) to be higher, lower, or the same as the $R^2$ for the first model (with only `bill` as the predictor)? Explain your reasoning.\n\n> Add response here.\n\n## Exercise 6\n\nFit a model predicting tip percentage from bill amount and meal, calculate its $R^2$, and comment on your guess from the previous exercise.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n# Adjusted $R^2$\n\n## Exercise 7\n\nCalculate adjusted $R^2$ for the two models. Is adding `meal` to a model predicting `tip_percentage` from `bill` useful?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n# Stepwise model selection\n\n## Backward elimination\n\nBackward elimination starts with the full model (the model that includes all potential predictor variables). Variables are eliminated one-at-a-time from the model until we cannot improve the model any further.\n\nProcedure:\n\n1.  Start with a model that has all predictors we consider and compute the adjusted $R^2$.\n\n2.  Next fit every possible model with 1 fewer predictor.\n\n3.  Compare adjusted $R^2$s to select the best model (highest adjusted $R^2$) with 1 fewer predictor.\n\n4.  Repeat steps 2 and 3 until adjusted $R^2$ no longer increases.\n\n## Forward selection\n\nForward selection is the reverse of the backward elimination technique. Instead, of eliminating variables one-at-a-time, we add variables one-at-a-time until we cannot find any variables that improve the model any further.\n\nProcedure:\n\n1.  Start with a model that has no predictors.\n\n2.  Next fit every possible model with 1 additional predictor and calculate adjusted $R^2$ of each model.\n\n3.  Compare adjusted $R^2$ values to select the best model (highest adjusted $R^2$) with 1 additional predictor.\n\n4.  Repeat steps 2 and 3 until adjusted $R^2$ no longer increases.\n\n## Exercise 8\n\nPerform backward elimination to find the best model for predicting `tip_percentage` from `meal`, `party`, `alcohol`, `bill`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n## Exercise 9\n\nPerform forward selection to find the best model for predicting `tip_percentage` from `meal`, `party`, `alcohol`, `bill`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n## Exercise 10\n\nFit the \"best\" model and interpret it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\n> Add response here.\n\n# Predictive performance\n\nA common way of evaluating the predictive performance of a model is to test it against new data that was not used to build the model in the first place. In machine learning, this new dataset is commonly referred to as **testing data**, and the dataset that was used to build and select the model is commonly referred to as **training data**.\n\nLet's first load the new data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntips_test <- read_csv(\"data/tips-test.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 40 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): day, meal, payment, age, gift_card, comps, alcohol, bday\ndbl (5): party, bill, w_tip, tip, tip_percentage\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nThere are 40 observations in this new dataset, and it has all the same columns as our existing dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(tips_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 40\nColumns: 13\n$ day            <chr> \"Tuesday\", \"Tuesday\", \"Sunday\", \"Friday\", \"Friday\", \"Sa…\n$ meal           <chr> \"Late Night\", \"Dinner\", \"Lunch\", \"Late Night\", \"Late Ni…\n$ payment        <chr> \"Credit\", \"Cash\", \"Cash\", \"Cash\", \"Credit\", \"Credit\", \"…\n$ party          <dbl> 1, 2, 2, 1, 3, 5, 4, 3, 3, 2, 1, 6, 4, 4, 6, 1, 2, 2, 3…\n$ age            <chr> \"Yadult\", \"Middle\", \"SenCit\", \"Yadult\", \"Middle\", \"Midd…\n$ gift_card      <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"…\n$ comps          <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"…\n$ alcohol        <chr> \"No\", \"No\", \"No\", \"No\", \"Yes\", \"No\", \"Yes\", \"No\", \"No\",…\n$ bday           <chr> \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"No\", \"…\n$ bill           <dbl> 3.74, 26.54, 25.68, 4.98, 25.40, 64.28, 57.86, 30.38, 3…\n$ w_tip          <dbl> 4.74, 31.00, 30.00, 5.00, 29.40, 74.28, 67.86, 35.38, 3…\n$ tip            <dbl> 1.00, 4.46, 4.32, 0.02, 4.00, 10.00, 10.00, 5.00, 3.48,…\n$ tip_percentage <dbl> 0.267379679, 0.168048229, 0.168224299, 0.004016064, 0.1…\n```\n\n\n:::\n:::\n\n\nLet's use our model to make predictions for `tip_percentage` for these new data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nWe can plot the predicted values of `tip_percentage` against the observed values to see how well we're doing.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nWe can also quantify the average error in our predictions with a measure called **root mean square error**, RMSE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nWhat this value tells us is that our predictions are off by, on average, approximately \\_\\_\\_.\n\nLet's take a look back at the tip percentage variables in this dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code here\n```\n:::\n\n\nThe tips range anywhere from \\_\\_\\_ to \\_\\_\\_ and our predictions are off, on average, by \\_\\_\\_. It's not great, and it's not terrible either. This, of course, is not a very technical assessment of the predictive performance of our model. There are much more formal ways of evaluating the predictive performance of a model using RMSE, but this is a good starting point for making sense of how well you're doing with your predictions.\n",
    "supporting": [
      "ae-08-tips_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}