{
  "hash": "083efc610a644a5f49425cf13fef2272",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bone density\"\ncategories: \n  - Application exercise\n  - Suggested answers\nfig-width: 6\nfig-asp: 0.618\n---\n\n\nIn this application exercise, we'll introduce and work with the normal distribution.\n\n# Goals\n\n-   Calculate probabilities under the normal curve\n\n-   Understand Z scores\n\n-   Build intuition for hypothesis testing and confidence interval building with the normal distribution\n\n# Packages and data\n\nWe'll use the **tidyverse** and **openintro** packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(openintro)\n```\n:::\n\n\n# Bone density - population\n\nSuppose the bone density for 65-year-old women is normally distributed with mean 809 $mg/cm^3$ and standard deviation of 140 $mg/cm^3$.\n\nLet $x$ be the bone density of 65-year-old women. We can write this distribution of $x$ in mathematical notation as\n\n$$\nx \\sim N(\\mu = 809, \\sigma = 140)\n$$\n\nLet's set the parameters of this distribution as objects you can use later.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbone_density_mean <- 809\nbone_density_sd <- 140\n```\n:::\n\n\n## Exercise 1\n\nVisualize the distribution of bone density of 65-year-old women.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# option 1: ggplot2\nggplot(\n  data = tibble(x = c(bone_density_mean - bone_density_sd*3, bone_density_mean + bone_density_sd*3)),\n  aes(x = x)) +\n  stat_function(\n    fun = dnorm, \n    args = list(mean = bone_density_mean, sd = bone_density_sd)\n  )\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/viz-pop-1.png){width=576}\n:::\n\n```{.r .cell-code}\n# option 2: openintro -- shortcut\nnormTail(m = bone_density_mean, s = bone_density_sd)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/viz-pop-2.png){width=576}\n:::\n:::\n\n\n## Exercise 2\n\nBefore typing any code, based on what you know about the normal distribution, what do you expect the median bone density to be?\n\n*809* $mg/cm^3$*, since mean and median are roughly equal for symmetric distributions.*\n\n## Exercise 3\n\nWhat bone densities correspond to Q1 (25th percentile), Q2 (50th percentile), and Q3 (the 75th percentile) of this distribution? Use the `qnorm()` function to calculate these values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqnorm(p = 0.25, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 714.5714\n```\n\n\n:::\n\n```{.r .cell-code}\nqnorm(p = 0.50, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 809\n```\n\n\n:::\n\n```{.r .cell-code}\nqnorm(p = 0.75, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 903.4286\n```\n\n\n:::\n:::\n\n\n## Exercise 4\n\nThe densities of three woods are below:\n\n-   Plywood: 540 $mg/cm^3$\n\n-   Pine: 600 $mg/cm^3$\n\n-   Mahogany: 710 $mg/cm^3$\n\nLet's set these as variables we can use later:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplywood <- 540\npine <- 600\nmahogany <- 710\n```\n:::\n\n\nWhat is the probability that a randomly selected 65-year-old woman has bones less dense than Pine?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnormTail(m = bone_density_mean, s = bone_density_sd, L = pine)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/pine-pop-1.png){width=576}\n:::\n\n```{.r .cell-code}\npnorm(q = pine, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.06773729\n```\n\n\n:::\n:::\n\n\n## Exercise 5\n\nWould you be surprised if a randomly selected 65-year-old woman had bone density less than Mahogany? What if she had bone density less than Plywood? Use the respective probabilities to support your response.\n\n*No for Mahogany, yes for Plywood.*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mahogany\nnormTail(m = bone_density_mean, s = bone_density_sd, L = mahogany)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/mahogany-plywood-pop-1.png){width=576}\n:::\n\n```{.r .cell-code}\npnorm(q = mahogany, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2397389\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plywood\nnormTail(m = bone_density_mean, s = bone_density_sd, L = plywood)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/mahogany-plywood-pop-2.png){width=576}\n:::\n\n```{.r .cell-code}\npnorm(q = plywood, mean = bone_density_mean, sd = bone_density_sd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.02733885\n```\n\n\n:::\n:::\n\n\n# Bone density - sampling\n\nSuppose you want to analyze the mean bone density for a group of 10 randomly selected 65-year-old women.\n\n## Exercise 6\n\nAre the conditions for the Central Limit Theorem met?\n\n-   *Independence: Yes, random sampling.*\n\n-   *Sample size/distribution: Yes, sample size is small, but the population distribution is normal, so the sampling distribution will be a well.*\n\n## Exercise 7\n\nWhat is the shape, center, and spread of the distribution of the mean bone density for a group of 10 randomly selected 65-year-old women?\n\n$$\n\\bar{x} \\sim N(mu = 809, SE = 140 / \\sqrt{10} \\approx 44)\n$$\n\n## Exercise 8\n\nWhat is the probability that the mean bone density for the group of 10 randomly-selected 65-year-old women is less dense than Pine?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbone_density_se <- 44\n\nnormTail(m = bone_density_mean, s = bone_density_se, L = pine)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/pine-sampling-1.png){width=576}\n:::\n\n```{.r .cell-code}\npnorm(q = pine, mean = bone_density_mean, sd = bone_density_se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.017083e-06\n```\n\n\n:::\n:::\n\n\n## Exercise 9\n\nWould you be surprised if a group of 10 randomly-selected 65-year old women had a mean bone density less than Mahogany? What the group had a mean bone density less than Plywood? Use the respective probabilities to support your response.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnormTail(m = bone_density_mean, s = bone_density_se, L = mahogany)\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/mahogany-plywood-sampling-1.png){width=576}\n:::\n\n```{.r .cell-code}\npnorm(q = mahogany, mean = bone_density_mean, sd = bone_density_se)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01222447\n```\n\n\n:::\n:::\n\n\n## Exercise 10\n\nExplain how your answers differ in similar sounding earlier vs. later exercises.\n\n*The probabilities are much smaller for the later exercises (sampling distribution) compared to the earlier (population distribution).*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = tibble(x = c(bone_density_mean - bone_density_sd*3, bone_density_mean + bone_density_sd*3)),\n  aes(x = x)) +\n  stat_function(\n    fun = dnorm, \n    args = list(mean = bone_density_mean, sd = bone_density_sd)\n  ) +\n  stat_function(\n    fun = dnorm, \n    args = list(mean = bone_density_mean, sd = 44),\n    linetype = \"dashed\",\n    color = \"blue\"\n  ) +\n  geom_vline(\n    xintercept = c(plywood, pine, mahogany),\n    color = c(\"#deb887\", \"#01796f\", \"#c04000\"),\n    linewidth = 1\n  ) +\n  annotate(\n    geom = \"label\",\n    x = c(plywood, pine, mahogany),\n    y = c(0.006, 0.007, 0.008),\n    color = c(\"#deb887\", \"#01796f\", \"#c04000\"),\n    label = c(\"plywood\", \"pine\", \"mahogany\")\n  ) +\n  annotate(\n    geom = \"text\",\n    x = 1000, y = 0.0018,\n    label = \"Population\\ndistribution\",\n    hjust = 0,\n    fontface = \"bold\"\n  ) +\n  annotate(\n    geom = \"text\",\n    x = 875, y = 0.005,\n    label = \"Sampling\\ndistribution\",\n    hjust = 0,\n    fontface = \"bold\",\n    color = \"blue\"\n  )\n```\n\n::: {.cell-output-display}\n![](ae-11-bone-density-sa_files/figure-html/viz-comparison-1.png){width=576}\n:::\n:::\n",
    "supporting": [
      "ae-11-bone-density-sa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}