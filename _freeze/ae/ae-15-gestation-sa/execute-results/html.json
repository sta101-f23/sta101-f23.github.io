{
  "hash": "50328f6d429a43d008c9add8e633fc96",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Length of gestation\"\ncategories: \n  - Application exercise\nfig-width: 6\nfig-asp: 0.618\neditor_options: \n  chunk_output_type: console\n---\n\n\nIn this application exercise, we'll do inference for a single mean, using simulation-based and mathematical models.\n\n# Packages\n\nWe'll use the **tidyverse**, **tidymodels**, and **openintro** packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(openintro)\n```\n:::\n\n\n# Data\n\nEvery year, the United States Department of Health and Human Services releases to the public a large dataset containing information on births recorded in the country. This dataset has been of interest to medical researchers who are studying the relation between habits and practices of expectant mothers and the birth of their children. In this case study we work with a random sample of 1,000 cases from the dataset released in 2014. The length of pregnancy, measured in weeks, is commonly referred to as gestation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(births14)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,000\nColumns: 13\n$ fage           <int> 34, 36, 37, NA, 32, 32, 37, 29, 30, 29, 30, 34, 28, 28,…\n$ mage           <dbl> 34, 31, 36, 16, 31, 26, 36, 24, 32, 26, 34, 27, 22, 31,…\n$ mature         <chr> \"younger mom\", \"younger mom\", \"mature mom\", \"younger mo…\n$ weeks          <dbl> 37, 41, 37, 38, 36, 39, 36, 40, 39, 39, 42, 40, 40, 39,…\n$ premie         <chr> \"full term\", \"full term\", \"full term\", \"full term\", \"pr…\n$ visits         <dbl> 14, 12, 10, NA, 12, 14, 10, 13, 15, 11, 14, 16, 20, 15,…\n$ gained         <dbl> 28, 41, 28, 29, 48, 45, 20, 65, 25, 22, 40, 30, 31, NA,…\n$ weight         <dbl> 6.96, 8.86, 7.51, 6.19, 6.75, 6.69, 6.13, 6.74, 8.94, 9…\n$ lowbirthweight <chr> \"not low\", \"not low\", \"not low\", \"not low\", \"not low\", …\n$ sex            <chr> \"male\", \"female\", \"female\", \"male\", \"female\", \"female\",…\n$ habit          <chr> \"nonsmoker\", \"nonsmoker\", \"nonsmoker\", \"nonsmoker\", \"no…\n$ marital        <chr> \"married\", \"married\", \"married\", \"not married\", \"marrie…\n$ whitemom       <chr> \"white\", \"white\", \"not white\", \"white\", \"white\", \"white…\n```\n\n\n:::\n:::\n\n\n# Bootstrap confidence intervals\n\n## Exercise 1\n\nConstruct and interpret a 95% confidence interval, using the standard error method with the `get_ci()` function, for the average length of gestation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(12345)\n\nboot_dist <- births14 |>\n  specify(response = weeks) |>\n  generate(reps = 1000, type = \"bootstrap\") |>\n  calculate(stat = \"mean\")\n\nobs_stat <- births14 |>\n  specify(response = weeks) |>\n  calculate(stat = \"mean\")\n\nboot_dist |>\n  get_ci(\n    type = \"se\",\n    point_estimate = obs_stat\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1     38.5     38.8\n```\n\n\n:::\n:::\n\n\n*Add response here.*\n\n## Exercise 2\n\nConstruct the interval **without** using the `get_ci()` (or `get_confidence_interval()`) function.\n\n> sample mean $\\pm$ ME\n>\n> = sample mean $\\pm$ critical value $\\times$ SE of the sample mean\n>\n> = sample mean $\\pm$ 2 $\\times$ SE of the sample mean\n>\n> = sample mean $\\pm$ 2 $\\times$ SD of the bootstrap distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nse <- boot_dist |>\n  summarize(se = sd(stat)) |>\n  pull(se)\nobs_stat |>\n  mutate(\n    lower = stat - 2*se,\n    upper = stat + 2*se\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nResponse: weeks (numeric)\n# A tibble: 1 × 3\n   stat lower upper\n  <dbl> <dbl> <dbl>\n1  38.7  38.5  38.8\n```\n\n\n:::\n:::\n\n\n## Exercise 3\n\nWould you expect a 90% confidence interval for the average length of gestation to be wider or narrower? Explain your reasoning.\n\n*Narrower.*\n\n## Exercise 4\n\nNow construct a 90% confidence interval for the average length of gestation and confirm your answer from the previous exercise. Repeat as little of your code as possible.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#obs_stat |>\n#  mutate(\n#    lower = stat - 1.64*se,\n#    upper = stat + 1.64*se\n#  )\n\nboot_dist |>\n  get_ci(\n    level = 0.90,\n    type = \"se\",\n    point_estimate = obs_stat\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1     38.5     38.8\n```\n\n\n:::\n:::\n\n\n## Confidence intervals with mathematical models\n\nIf technical conditions are satisfied, the distribution of the sampling mean (i.e., the sampling distribution) follows the t-distribution with n - 1 degrees of freedom, where n is the sample size.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsampling_dist <- births14 |>\n  specify(response = weeks) |>\n  assume(distribution = \"t\")\n\nsampling_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nA T distribution with 999 degrees of freedom.\n```\n\n\n:::\n\n```{.r .cell-code}\nvisualize(sampling_dist)\n```\n\n::: {.cell-output-display}\n![](ae-15-gestation-sa_files/figure-html/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n\n## Exercise 5\n\nConstruct and visualize a confidence interval using mathematical models for the average length of gestation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# option 1 - using infer pipelines: ci using mathematical models\nbirths14 |>\n  specify(response = weeks) |>\n  assume(distribution = \"t\") |>\n  get_ci(point_estimate = obs_stat, type = \"se\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  lower_ci upper_ci\n     <dbl>    <dbl>\n1     38.5     38.8\n```\n\n\n:::\n\n```{.r .cell-code}\n# option 2 - by hand:\n## se using mathematical models\ns <- births14 |>\n  summarize(s = sd(weeks)) |>\n  pull(s)\nn <- nrow(births14)\n\nse <- s / sqrt(n)\nse\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.08111118\n```\n\n\n:::\n\n```{.r .cell-code}\n## me using mathematical models\nme <- 2 * se\n\n## ci using mathematical models\nxbar <- obs_stat |>\n  pull(stat)\nxbar + c(-1, 1) * me\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 38.50378 38.82822\n```\n\n\n:::\n:::\n",
    "supporting": [
      "ae-15-gestation-sa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}